<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Habits - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</title>
    <link rel="stylesheet" href="design-system.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Quicksand:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Telegram WebApp API -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="telegram-webapp.js"></script>
    
    <style> html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Habits - –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</title>
    <link rel="stylesheet" href="design-system.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Quicksand:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        .task-hero {
            text-align: center;
            padding: var(--spacing-lg) 0;
            background: linear-gradient(135deg, rgba(107, 142, 78, 0.1) 0%, rgba(123, 160, 91, 0.1) 100%);
            border-radius: var(--border-radius-xl);
            margin-bottom: var(--spacing-lg);
            border: 1px solid rgba(107, 142, 78, 0.3);
        }
        
        .task-creator {
            background: var(--bg-card);
            border: 1px solid rgba(107, 142, 78, 0.2);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-lg);
            margin: var(--spacing-md) 0;
            box-shadow: var(--shadow-card);
        }
        
        .task-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: var(--spacing-sm);
            margin: var(--spacing-md) 0;
        }
        
        .task-type {
            background: var(--bg-elevated);
            border: 2px solid rgba(107, 142, 78, 0.2);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-md);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .task-type:hover {
            border-color: var(--primary-green);
            transform: translateY(-2px);
            box-shadow: var(--glow-green);
        }
        
        .task-type.selected {
            border-color: var(--primary-green);
            background: rgba(107, 142, 78, 0.1);
            box-shadow: var(--glow-green);
        }
        
        .task-type-icon {
            font-size: 2rem;
            margin-bottom: var(--spacing-xs);
            display: block;
        }
        
        .task-type-title {
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
        }
        
        .task-type-desc {
            font-size: var(--text-xs);
            color: var(--text-muted);
        }
        
        .assignee-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: var(--spacing-sm);
            margin: var(--spacing-sm) 0;
        }
        
        .assignee-option {
            background: var(--bg-elevated);
            border: 2px solid rgba(107, 142, 78, 0.2);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-sm);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .assignee-option:hover {
            border-color: var(--primary-green);
        }
        
        .assignee-option.selected {
            border-color: var(--primary-green);
            background: rgba(107, 142, 78, 0.1);
        }
        
        .assignee-avatar {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            margin: 0 auto var(--spacing-xs);
            border: 2px solid var(--primary-green);
        }
        
        .time-picker {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-sm);
            margin: var(--spacing-sm) 0;
        }
        
        .reward-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: var(--spacing-xs);
            margin: var(--spacing-sm) 0;
        }
        
        .reward-option {
            background: var(--bg-elevated);
            border: 2px solid rgba(107, 142, 78, 0.2);
            border-radius: var(--border-radius);
            padding: var(--spacing-xs);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: var(--text-sm);
        }
        
        .reward-option:hover {
            border-color: var(--primary-green);
        }
        
        .reward-option.selected {
            border-color: var(--primary-green);
            background: rgba(107, 142, 78, 0.1);
            color: var(--primary-green);
            font-weight: var(--font-semibold);
        }
        
        .template-suggestions {
            background: rgba(168, 201, 138, 0.1);
            border: 1px solid var(--soft-green);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-md);
            margin: var(--spacing-lg) 0;
        }
        
        .template-item {
            background: var(--bg-card);
            border: 1px solid rgba(107, 142, 78, 0.2);
            border-radius: var(--border-radius);
            padding: var(--spacing-sm);
            margin: var(--spacing-xs) 0;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        .template-item:hover {
            border-color: var(--primary-green);
            background: rgba(107, 142, 78, 0.05);
        }
        
        .template-icon {
            width: 32px;
            height: 32px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .task-preview {
            background: rgba(123, 160, 91, 0.1);
            border: 1px solid var(--accent-green);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-md);
            margin: var(--spacing-lg) 0;
        }
        
        .preview-card {
            background: var(--bg-card);
            border: 1px solid rgba(107, 142, 78, 0.2);
            border-left: 2px solid var(--primary-green);
            border-radius: var(--border-radius);
            padding: var(--spacing-sm);
            margin: var(--spacing-sm) 0;
        }
        
        .mascot-tip {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            background: var(--gradient-reward);
            padding: var(--spacing-sm);
            border-radius: var(--border-radius-lg);
            margin: var(--spacing-md) 0;
            border: 2px solid var(--accent-green);
        }
        
        .difficulty-selector {
            display: flex;
            gap: var(--spacing-xs);
            margin: var(--spacing-sm) 0;
        }
        
        .difficulty-option {
            flex: 1;
            padding: var(--spacing-xs);
            border: 2px solid rgba(107, 142, 78, 0.2);
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: var(--text-sm);
        }
        
        .difficulty-easy {
            border-color: var(--success);
        }
        
        .difficulty-medium {
            border-color: var(--warning);
        }
        
        .difficulty-hard {
            border-color: var(--error);
        }
        
        .difficulty-option.selected {
            transform: scale(1.05);
            font-weight: var(--font-bold);
        }
        
        .difficulty-easy.selected {
            background: rgba(123, 160, 91, 0.2);
            color: var(--success);
        }
        
        .difficulty-medium.selected {
            background: rgba(197, 165, 114, 0.2);
            color: var(--warning);
        }
        
        .difficulty-hard.selected {
            background: rgba(193, 123, 123, 0.2);
            color: var(--error);
        }
        
        .recurring-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: var(--spacing-xs);
            margin: var(--spacing-sm) 0;
        }
        
        .recurring-option {
            padding: var(--spacing-xs);
            border: 2px solid rgba(107, 142, 78, 0.2);
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: var(--text-sm);
        }
        
        .recurring-option:hover {
            border-color: var(--primary-green);
        }
        
        .recurring-option.selected {
            border-color: var(--primary-green);
            background: rgba(107, 142, 78, 0.1);
            color: var(--primary-green);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–µ—Ä–æ–∏-–ø–æ–º–æ—â–Ω–∏–∫–∏ -->
        <div class="task-hero">
            <div class="mascot-container">
                <div class="mascot">üìã</div>
                <div class="mascot mascot-punk">‚ú®</div>
            </div>
            <h1 class="heading-1 text-neon">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É</h1>
            <p class="text-secondary">–•–∞–±–∏—Ç –∏ –•–∞–±–±–∏ –ø–æ–º–æ–≥—É—Ç —Å–æ–∑–¥–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—É—é –ø—Ä–∏–≤—ã—á–∫—É –¥–ª—è –≤–∞—à–µ–π —Å–µ–º—å–∏!</p>
        </div>

        <!-- –°–æ–≤–µ—Ç –æ—Ç —Ç–∞–ª–∏—Å–º–∞–Ω–æ–≤ -->
        <div class="mascot-tip">
            <div class="mascot-small">üí°</div>
            <div>
                <strong>–°–æ–≤–µ—Ç –æ—Ç –•–∞–±–±–∏:</strong> "–ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á! –õ—É—á—à–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª–µ–≥–∫—É—é –ø—Ä–∏–≤—ã—á–∫—É –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, —á–µ–º —Å–ª–æ–∂–Ω—É—é —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é üå±"
            </div>
        </div>

        <!-- –®–∞–±–ª–æ–Ω—ã –∑–∞–¥–∞—á -->
        <div class="template-suggestions">
            <h3 class="heading-3">üéØ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏</h3>
            <p class="text-secondary">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∑–∞–¥–∞—á—É</p>
            
            <div class="template-item" onclick="useTemplate('teeth')">
                <div class="template-icon">ü¶∑</div>
                <div>
                    <strong>–ß–∏—Å—Ç–∏—Ç—å –∑—É–±—ã</strong>
                    <div class="text-xs text-muted">–£—Ç—Ä–æ–º –∏ –≤–µ—á–µ—Ä–æ–º</div>
                </div>
            </div>
            
            <div class="template-item" onclick="useTemplate('reading')">
                <div class="template-icon">üìö</div>
                <div>
                    <strong>–ß–∏—Ç–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–Ω–æ–º</strong>
                    <div class="text-xs text-muted">15 –º–∏–Ω—É—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å</div>
                </div>
            </div>
            
            <div class="template-item" onclick="useTemplate('cleanup')">
                <div class="template-icon">üßπ</div>
                <div>
                    <strong>–£–±–∏—Ä–∞—Ç—å –∏–≥—Ä—É—à–∫–∏</strong>
                    <div class="text-xs text-muted">–ü–æ—Å–ª–µ –∏–≥—Ä</div>
                </div>
            </div>
            
            <div class="template-item" onclick="useTemplate('exercise')">
                <div class="template-icon">üèÉ</div>
                <div>
                    <strong>–°–µ–º–µ–π–Ω–∞—è –∑–∞—Ä—è–¥–∫–∞</strong>
                    <div class="text-xs text-muted">–£—Ç—Ä–æ–º –≤—Å–µ–π —Å–µ–º—å–µ–π</div>
                </div>
            </div>
        </div>

        <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
        <form class="task-creator" id="taskForm">
            <h2 class="heading-2">üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–¥–∞—á–∏</h2>
            
            <!-- –¢–∏–ø –∑–∞–¥–∞—á–∏ -->
            <div class="form-group">
                <label class="form-label">üé≠ –¢–∏–ø –∑–∞–¥–∞—á–∏</label>
                <div class="task-type-selector">
                    <div class="task-type" data-type="personal">
                        <span class="task-type-icon">üë§</span>
                        <div class="task-type-title">–õ–∏—á–Ω–∞—è</div>
                        <div class="task-type-desc">–î–ª—è –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞</div>
                    </div>
                    <div class="task-type" data-type="family">
                        <span class="task-type-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                        <div class="task-type-title">–°–µ–º–µ–π–Ω–∞—è</div>
                        <div class="task-type-desc">–î–ª—è –≤—Å–µ–π —Å–µ–º—å–∏</div>
                    </div>
                </div>
            </div>

            <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ -->
            <div class="form-group">
                <label class="form-label" for="taskTitle">üìå –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
                <input 
                    type="text" 
                    id="taskTitle" 
                    class="form-input" 
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–æ—á–∏—Å—Ç–∏—Ç—å –∑—É–±—ã –ø–µ—Ä–µ–¥ —Å–Ω–æ–º"
                    required
                >
            </div>

            <div class="form-group">
                <label class="form-label" for="taskDescription">üìù –û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                <textarea 
                    id="taskDescription" 
                    class="form-input" 
                    rows="2"
                    placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –æ –∑–∞–¥–∞—á–µ..."
                ></textarea>
            </div>

            <!-- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ -->
            <div class="form-group">
                <label class="form-label">üë• –ö–æ–º—É –Ω–∞–∑–Ω–∞—á–∏—Ç—å</label>
                <div class="assignee-selector">
                    <div class="assignee-option" data-assignee="anna">
                        <div class="assignee-avatar">üëß</div>
                        <div class="text-sm">–ê–Ω—è</div>
                    </div>
                    <div class="assignee-option" data-assignee="max">
                        <div class="assignee-avatar">üë¶</div>
                        <div class="text-sm">–ú–∞–∫—Å–∏–º</div>
                    </div>
                    <div class="assignee-option" data-assignee="parent">
                        <div class="assignee-avatar">üë®‚Äçüíº</div>
                        <div class="text-sm">–†–æ–¥–∏—Ç–µ–ª–∏</div>
                    </div>
                    <div class="assignee-option" data-assignee="all">
                        <div class="assignee-avatar">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                        <div class="text-sm">–í—Å–µ</div>
                    </div>
                </div>
            </div>

            <!-- –°–ª–æ–∂–Ω–æ—Å—Ç—å -->
            <div class="form-group">
                <label class="form-label">‚≠ê –°–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á–∏</label>
                <div class="difficulty-selector">
                    <div class="difficulty-option difficulty-easy" data-difficulty="easy">
                        üü¢ –õ–µ–≥–∫–æ<br>
                        <span class="text-xs">5 –∑–≤–µ–∑–¥</span>
                    </div>
                    <div class="difficulty-option difficulty-medium" data-difficulty="medium">
                        üü° –°—Ä–µ–¥–Ω–µ<br>
                        <span class="text-xs">10 –∑–≤–µ–∑–¥</span>
                    </div>
                    <div class="difficulty-option difficulty-hard" data-difficulty="hard">
                        üî¥ –°–ª–æ–∂–Ω–æ<br>
                        <span class="text-xs">20 –∑–≤–µ–∑–¥</span>
                    </div>
                </div>
            </div>

            <!-- –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ -->
            <div class="form-group">
                <label class="form-label">üîÑ –ö–∞–∫ —á–∞—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å</label>
                <div class="recurring-options">
                    <div class="recurring-option" data-recurring="daily">–ö–∞–∂–¥—ã–π –¥–µ–Ω—å</div>
                    <div class="recurring-option" data-recurring="weekdays">–ë—É–¥–Ω–∏</div>
                    <div class="recurring-option" data-recurring="weekends">–í—ã—Ö–æ–¥–Ω—ã–µ</div>
                    <div class="recurring-option" data-recurring="weekly">–†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é</div>
                    <div class="recurring-option" data-recurring="custom">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å</div>
                </div>
            </div>

            <!-- –í—Ä–µ–º—è -->
            <div class="form-group">
                <label class="form-label">‚è∞ –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                <div class="time-picker">
                    <select class="form-input form-select" id="taskTime">
                        <option value="">–õ—é–±–æ–µ –≤—Ä–µ–º—è</option>
                        <option value="morning">–£—Ç—Ä–æ–º (7:00-12:00)</option>
                        <option value="afternoon">–î–Ω–µ–º (12:00-18:00)</option>
                        <option value="evening">–í–µ—á–µ—Ä–æ–º (18:00-22:00)</option>
                        <option value="custom">–¢–æ—á–Ω–æ–µ –≤—Ä–µ–º—è</option>
                    </select>
                    <input type="time" class="form-input" id="exactTime" style="display: none;">
                </div>
            </div>

            <!-- –ù–∞–≥—Ä–∞–¥–∞ -->
            <div class="form-group">
                <label class="form-label">üèÜ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                <div class="reward-selector">
                    <div class="reward-option" data-reward="5">+5 ‚≠ê</div>
                    <div class="reward-option" data-reward="10">+10 ‚≠ê</div>
                    <div class="reward-option" data-reward="15">+15 ‚≠ê</div>
                    <div class="reward-option" data-reward="sticker">–ù–∞–∫–ª–µ–π–∫–∞</div>
                    <div class="reward-option" data-reward="privilege">–ü—Ä–∏–≤–∏–ª–µ–≥–∏—è</div>
                </div>
            </div>

            <!-- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä -->
            <div class="task-preview" id="taskPreview" style="display: none;">
                <h3 class="heading-3">üëÄ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</h3>
                <div class="preview-card" id="previewContent">
                    <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="flex gap-sm" style="margin-top: var(--spacing-lg);">
                <button type="button" class="btn btn-ghost" onclick="goBack()">
                    ‚¨ÖÔ∏è –û—Ç–º–µ–Ω–∞
                </button>
                <button type="submit" class="btn btn-primary btn-large" style="flex: 1;">
                    –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É ‚ú®
                </button>
            </div>
        </form>
    </div>

    <script>
        const templates = {
            teeth: {
                title: "–ü–æ—á–∏—Å—Ç–∏—Ç—å –∑—É–±—ã",
                description: "–ß–∏—Å—Ç–∏—Ç—å –∑—É–±—ã —É—Ç—Ä–æ–º –∏ –≤–µ—á–µ—Ä–æ–º",
                difficulty: "easy",
                recurring: "daily",
                time: "morning"
            },
            reading: {
                title: "–ß–∏—Ç–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–Ω–æ–º",
                description: "15 –º–∏–Ω—É—Ç —á—Ç–µ–Ω–∏—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å",
                difficulty: "easy",
                recurring: "daily",
                time: "evening"
            },
            cleanup: {
                title: "–£–±–∏—Ä–∞—Ç—å –∏–≥—Ä—É—à–∫–∏",
                description: "–£–±–∏—Ä–∞—Ç—å –∏–≥—Ä—É—à–∫–∏ –ø–æ—Å–ª–µ –∏–≥—Ä",
                difficulty: "medium",
                recurring: "daily",
                time: "evening"
            },
            exercise: {
                title: "–°–µ–º–µ–π–Ω–∞—è –∑–∞—Ä—è–¥–∫–∞",
                description: "10 –º–∏–Ω—É—Ç –∑–∞—Ä—è–¥–∫–∏ –≤—Å–µ–π —Å–µ–º—å–µ–π",
                difficulty: "medium",
                recurring: "daily",
                time: "morning"
            }
        };

        function useTemplate(templateId) {
            const template = templates[templateId];
            if (!template) return;

            document.getElementById('taskTitle').value = template.title;
            document.getElementById('taskDescription').value = template.description;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å
            document.querySelectorAll('.difficulty-option').forEach(opt => opt.classList.remove('selected'));
            document.querySelector(`[data-difficulty="${template.difficulty}"]`).classList.add('selected');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ
            document.querySelectorAll('.recurring-option').forEach(opt => opt.classList.remove('selected'));
            document.querySelector(`[data-recurring="${template.recurring}"]`).classList.add('selected');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–µ–º—è
            document.getElementById('taskTime').value = template.time;
            
            updatePreview();
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–±–æ—Ä–∞ –æ–ø—Ü–∏–π
        document.querySelectorAll('.task-type').forEach(type => {
            type.addEventListener('click', () => {
                document.querySelectorAll('.task-type').forEach(t => t.classList.remove('selected'));
                type.classList.add('selected');
                updatePreview();
            });
        });

        document.querySelectorAll('.assignee-option').forEach(assignee => {
            assignee.addEventListener('click', () => {
                document.querySelectorAll('.assignee-option').forEach(a => a.classList.remove('selected'));
                assignee.classList.add('selected');
                updatePreview();
            });
        });

        document.querySelectorAll('.difficulty-option').forEach(difficulty => {
            difficulty.addEventListener('click', () => {
                document.querySelectorAll('.difficulty-option').forEach(d => d.classList.remove('selected'));
                difficulty.classList.add('selected');
                updatePreview();
            });
        });

        document.querySelectorAll('.recurring-option').forEach(recurring => {
            recurring.addEventListener('click', () => {
                document.querySelectorAll('.recurring-option').forEach(r => r.classList.remove('selected'));
                recurring.classList.add('selected');
                updatePreview();
            });
        });

        document.querySelectorAll('.reward-option').forEach(reward => {
            reward.addEventListener('click', () => {
                reward.classList.toggle('selected');
                updatePreview();
            });
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
        document.getElementById('taskTime').addEventListener('change', (e) => {
            const exactTimeInput = document.getElementById('exactTime');
            if (e.target.value === 'custom') {
                exactTimeInput.style.display = 'block';
            } else {
                exactTimeInput.style.display = 'none';
            }
            updatePreview();
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
        document.getElementById('taskTitle').addEventListener('input', updatePreview);
        document.getElementById('taskDescription').addEventListener('input', updatePreview);

        function updatePreview() {
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const selectedType = document.querySelector('.task-type.selected');
            const selectedAssignee = document.querySelector('.assignee-option.selected');
            const selectedDifficulty = document.querySelector('.difficulty-option.selected');
            const selectedRecurring = document.querySelector('.recurring-option.selected');
            const selectedRewards = document.querySelectorAll('.reward-option.selected');

            if (!title) {
                document.getElementById('taskPreview').style.display = 'none';
                return;
            }

            const preview = document.getElementById('taskPreview');
            const content = document.getElementById('previewContent');

            let difficultyStars = '‚≠ê 5';
            if (selectedDifficulty) {
                const difficulty = selectedDifficulty.dataset.difficulty;
                difficultyStars = difficulty === 'easy' ? '‚≠ê 5' : 
                                difficulty === 'medium' ? '‚≠ê 10' : '‚≠ê 20';
            }

            let assigneeText = '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–æ';
            if (selectedAssignee) {
                const assignee = selectedAssignee.dataset.assignee;
                assigneeText = assignee === 'anna' ? 'üëß –ê–Ω—è' :
                              assignee === 'max' ? 'üë¶ –ú–∞–∫—Å–∏–º' :
                              assignee === 'parent' ? 'üë®‚Äçüíº –†–æ–¥–∏—Ç–µ–ª–∏' :
                              assignee === 'all' ? 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –í—Å—è —Å–µ–º—å—è' : '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–æ';
            }

            content.innerHTML = `
                <div class="flex justify-between items-center" style="margin-bottom: var(--spacing-xs);">
                    <h4 class="heading-4">${title}</h4>
                    <span class="badge badge-success">–ù–æ–≤–∞—è</span>
                </div>
                ${description ? `<p class="text-secondary" style="margin-bottom: var(--spacing-xs);">${description}</p>` : ''}
                <div class="flex justify-between items-center">
                    <span class="text-sm text-muted">${assigneeText}</span>
                    <div class="points-display">${difficultyStars}</div>
                </div>
            `;

            preview.style.display = 'block';
        }

        function goBack() {
            if (confirm('üå± –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏?\n\n–í—Å–µ –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
                window.location.href = 'index.html';
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        document.getElementById('taskForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const title = document.getElementById('taskTitle').value;
            const selectedAssignee = document.querySelector('.assignee-option.selected');
            const selectedDifficulty = document.querySelector('.difficulty-option.selected');

            if (!title) {
                alert('üå± –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏!');
                return;
            }

            if (!selectedAssignee) {
                alert('üå± –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ, –∫–æ–º—É –Ω–∞–∑–Ω–∞—á–∏—Ç—å –∑–∞–¥–∞—á—É!');
                return;
            }

            if (!selectedDifficulty) {
                alert('üå± –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á–∏!');
                return;
            }

            // –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞
            const button = e.target.querySelector('button[type="submit"]');
            button.textContent = '‚úÖ –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞!';
            button.classList.remove('btn-primary');
            button.classList.add('btn-reward');

            setTimeout(() => {
                alert('üéâ –û—Ç–ª–∏—á–Ω–æ! –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞!\n\n‚≠ê –í—ã –ø–æ–ª—É—á–∏–ª–∏ +10 –∑–≤–µ–∑–¥ –∑–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏!\n\nüå± –•–∞–±–∏—Ç –∏ –•–∞–±–±–∏ —É–∂–µ –¥–æ–±–∞–≤–∏–ª–∏ –µ—ë –≤ —Å–ø–∏—Å–æ–∫ –¥–µ–ª!');
                window.location.href = 'index.html';
            }, 1500);
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            // –í—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—ã–µ –æ–ø—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            document.querySelector('.task-type[data-type="personal"]').classList.add('selected');
            document.querySelector('.difficulty-option[data-difficulty="easy"]').classList.add('selected');
            document.querySelector('.recurring-option[data-recurring="daily"]').classList.add('selected');
        });
    </script>
</body>
</html>
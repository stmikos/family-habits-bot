# üå± Family Habits Bot

**Telegram-–±–æ—Ç –¥–ª—è —Å–µ–º–µ–π–Ω–æ–≥–æ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ø—Ä–∏–≤—ã—á–µ–∫ —Å WebApp –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º**

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–µ–º–µ–π–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫ —Å —Å–∏—Å—Ç–µ–º–æ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –Ω–∞–≥—Ä–∞–¥.

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- üë®‚Äçüë©‚Äçüëß‚Äçüë¶ **–°–µ–º–µ–π–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º–µ–π–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ —Å –¥–µ—Ç—å–º–∏
- üìã **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–µ–∫ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞  
- üè™ **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω** - —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–≥—Ä–∞–¥ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å–µ–º—å–∏
- üë§ **–ü—Ä–æ—Ñ–∏–ª–∏** - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- üé® **–ö—Ä–∞—Å–∏–≤—ã–π –¥–∏–∑–∞–π–Ω** - –∑–µ–ª–µ–Ω–∞—è –ø—Ä–∏—Ä–æ–¥–Ω–∞—è —Ç–µ–º–∞ —Å –º–∞—Å–∫–æ—Ç–∞–º–∏ Habit –∏ Habby

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/stmikos/family-habits-bot.git
cd family-habits-bot
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
cd webapp && pip install -r requirements.txt && cd ..
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª, –¥–æ–±–∞–≤–∏–≤ –≤–∞—à bot token
```

### 4. –ó–∞–ø—É—Å–∫ WebApp —Å–µ—Ä–≤–µ—Ä–∞
```bash
cd webapp
python server.py
```

### 5. –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞
```bash
# –í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
python -m app.bot.main
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è GitHub Codespaces

1. **–ü–æ–ª—É—á–∏—Ç–µ URL Codespaces:**
```bash
echo "https://$CODESPACE_NAME-8000.app.github.dev"
```

2. **–û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª:**
```bash
WEBAPP_URL=https://your-codespace-name-8000.app.github.dev
```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ WebApp –≤ @BotFather:**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/mybots` –≤ @BotFather
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ ‚Üí Bot Settings ‚Üí Menu Button ‚Üí Edit menu button URL
   - –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à Codespaces URL

## üì± WebApp –°—Ç—Ä–∞–Ω–∏—Ü—ã

- **–ì–ª–∞–≤–Ω–∞—è** (`/`) - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** (`/registration`) - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º–µ–π–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- **–î–µ—Ç–∏** (`/registration-children`) - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ç–µ–π –≤ —Å–µ–º—å—é
- **–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ** (`/welcome`) - —Å—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á** (`/create-task`) - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫
- **–ú–∞–≥–∞–∑–∏–Ω** (`/shop`) - –ø–æ–∫—É–ø–∫–∞ –Ω–∞–≥—Ä–∞–¥ –∑–∞ –º–æ–Ω–µ—Ç—ã
- **–ü—Ä–æ—Ñ–∏–ª—å** (`/profile`) - –ª–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** (`/statistics`) - –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

## ü§ñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- `/app` - –æ—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- `/family` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–º—å–µ–π
- `/tasks` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á
- `/shop` - –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω
- `/profile` - –ª–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å  
- `/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend:** Python 3.9+, FastAPI, aiogram 3.x
- **Database:** SQLite —Å Alembic –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
- **Frontend:** HTML5, CSS3, JavaScript
- **WebApp API:** Telegram WebApp API
- **UI Framework:** –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞
- **Charts:** Chart.js –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
family-habits-bot/
‚îú‚îÄ‚îÄ app/                    # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ bot/               # Telegram bot –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ core/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ db/                # –ú–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ services/          # –ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ webapp/                # WebApp –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ *.html            # HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îú‚îÄ‚îÄ design-system.css # –°–∏—Å—Ç–µ–º–∞ –¥–∏–∑–∞–π–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ telegram-webapp.js # Telegram WebApp API
‚îÇ   ‚îî‚îÄ‚îÄ server.py         # FastAPI —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ alembic/              # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ tests/                # –¢–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ docs/                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üé® –î–∏–∑–∞–π–Ω —Å–∏—Å—Ç–µ–º–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–µ–ª–µ–Ω—É—é –ø—Ä–∏—Ä–æ–¥–Ω—É—é —Ç–µ–º—É —Å:
- –û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç: `#2E7D32` (Forest Green)
- –ê–∫—Ü–µ–Ω—Ç–Ω—ã–π: `#4CAF50` (Success Green)  
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –∏ —Ç–µ–Ω–∏ –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤–∏–¥–∞
- –ú–∞—Å–∫–æ—Ç—ã Habit üå± –∏ Habby üçÉ
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [BOT_SETUP.md](BOT_SETUP.md) - –ü–æ–¥—Ä–æ–±–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞
- [TELEGRAM_WEBAPP_GUIDE.md](TELEGRAM_WEBAPP_GUIDE.md) - –ì–∞–π–¥ –ø–æ WebApp API
- [QUICK_START.md](QUICK_START.md) - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –°–º. [LICENSE](LICENSE) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [Issues](https://github.com/stmikos/family-habits-bot/issues)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Issue —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–ª–µ–¥—É–µ—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Å–µ–º–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –≤–º–µ—Å—Ç–µ!**

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ M2

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ M2:

- **ü§ñ Telegram Bot (aiogram 3.x)**
  - –†–æ–ª–∏: –†–æ–¥–∏—Ç–µ–ª—å/–†–µ–±—ë–Ω–æ–∫
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  - –ö–æ–º–∞–Ω–¥—ã: `/start`, `/info`, `/stats`

- **üì± MiniApp –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
  - –ö–Ω–æ–ø–∫–∏ WebApp –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∏ –¥–µ—Ç–µ–π
  - URL –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `WEBAPP_URL`

- **üìù FSM –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π**
  - 6-—ç—Ç–∞–ø–Ω—ã–π –¥–∏–∞–ª–æ–≥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è
  - –í—ã–±–æ—Ä —Ä–µ–±—ë–Ω–∫–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, —Ç–∏–ø (—Ç–µ–∫—Å—Ç/—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—á–∫–æ–≤ –∏ –º–æ–Ω–µ—Ç –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

- **‚≠ê –°–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤ –∏ –º–æ–Ω–µ—Ç**
  - –û—á–∫–∏ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π
  - –ú–æ–Ω–µ—Ç—ã –¥–ª—è –ø–æ–∫—É–ø–æ–∫ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
  - –ñ—É—Ä–Ω–∞–ª –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π `PointsLedger`

- **üõí –ú–∞–≥–∞–∑–∏–Ω (–æ—Å–Ω–æ–≤–∞)**
  - –ú–æ–¥–µ–ª–∏ `ShopItem`, `Purchase`
  - –î–µ–º–æ-—Ç–æ–≤–∞—Ä—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

- **üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
  - SQLAlchemy –º–æ–¥–µ–ª–∏ —Å Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
  - –ü–æ–ª—è `tg_id` –¥–ª—è —Å–≤—è–∑–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
  - Alembic –º–∏–≥—Ä–∞—Ü–∏–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
app/
‚îú‚îÄ‚îÄ bot/                    # Telegram Bot
‚îÇ   ‚îú‚îÄ‚îÄ handlers/          # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ start.py      # /start, —Ä–æ–ª–∏, –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks.py      # FSM —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin.py      # /info, /stats
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/      # Middleware
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.py       # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ main.py           # Dispatcher, –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ db/                    # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ session.py        # Async sessions
‚îú‚îÄ‚îÄ services/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ parent_service.py # –†–∞–±–æ—Ç–∞ —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ task_service.py   # –†–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏
‚îî‚îÄ‚îÄ core/                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ config.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    ‚îî‚îÄ‚îÄ logging.py        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env`:

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token_from_botfather
WEBAPP_URL=https://your-miniapp-domain.com

# Database
DATABASE_URL=sqlite+aiosqlite:///./family_habits.db

# Admin
ADMIN_USER_IDS=123456789,987654321
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
alembic upgrade head
```

### 4. –ó–∞–ø—É—Å–∫

```bash
# –î–µ–º–æ (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ Telegram)
python run_bot.py

# –° —Ä–µ–∞–ª—å–Ω—ã–º –±–æ—Ç–æ–º
python -m app.bot.main
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
python test_bot.py
```

## üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π:

1. **–°—Ç–∞—Ä—Ç**: `/start` ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞–∫ —Ä–æ–¥–∏—Ç–µ–ª—å
2. **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é**:
   - üè† **–°–µ–º–µ–π–Ω–∞—è –ø–∞–Ω–µ–ª—å** (MiniApp)
   - üìù **–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ** (FSM –¥–∏–∞–ª–æ–≥)
   - üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** / üë®‚Äçüë©‚Äçüëß‚Äçüë¶ **–î–µ—Ç–∏**

3. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è**:
   - –í—ã–±–æ—Ä —Ä–µ–±—ë–Ω–∫–∞
   - –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
   - –¢–∏–ø –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (—Ç–µ–∫—Å—Ç/—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)
   - –û—á–∫–∏ –∏ –º–æ–Ω–µ—Ç—ã –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

### –î–ª—è –¥–µ—Ç–µ–π:

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**: –†–æ–¥–∏—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ–±—ë–Ω–∫–∞, –ø–æ—Ç–æ–º —Ä–µ–±—ë–Ω–æ–∫ –ø–∏—à–µ—Ç `/start`
2. **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é**:
   - üéÆ **–ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è** (MiniApp)
   - üèÜ **–ú–æ–∏ –æ—á–∫–∏**
   - üõí **–ú–∞–≥–∞–∑–∏–Ω**

## üìä –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏:

- **`Family`** - —Å–µ–º—å—è (–ø–ª–∞–Ω FREE/PRO)
- **`Parent`** - —Ä–æ–¥–∏—Ç–µ–ª—å (—Å–≤—è–∑—å —Å Telegram —á–µ—Ä–µ–∑ `tg_id`)
- **`Child`** - —Ä–µ–±—ë–Ω–æ–∫ (–æ—á–∫–∏, –º–æ–Ω–µ—Ç—ã, `tg_id` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **`Task`** - –∑–∞–¥–∞–Ω–∏–µ (–æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è –∫ —Ä–µ–±—ë–Ω–∫—É)
- **`CheckIn`** - —Å–¥–∞—á–∞ –∑–∞–¥–∞–Ω–∏—è —Ä–µ–±—ë–Ω–∫–æ–º
- **`PointsLedger`** - –∂—É—Ä–Ω–∞–ª –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π
- **`ShopItem`** - —Ç–æ–≤–∞—Ä –≤ –º–∞–≥–∞–∑–∏–Ω–µ
- **`Purchase`** - –ø–æ–∫—É–ø–∫–∞ —Ä–µ–±—ë–Ω–∫–∞

## üîÑ FSM Workflow

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è:

```
1. waiting_for_child    ‚Üí –í—ã–±–æ—Ä —Ä–µ–±—ë–Ω–∫–∞
2. waiting_for_title    ‚Üí –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
3. waiting_for_description ‚Üí –û–ø–∏—Å–∞–Ω–∏–µ
4. waiting_for_type     ‚Üí –¢–∏–ø (—Ç–µ–∫—Å—Ç/—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)
5. waiting_for_points   ‚Üí –û—á–∫–∏ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
6. waiting_for_coins    ‚Üí –ú–æ–Ω–µ—Ç—ã –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
‚Üí –°–æ–∑–¥–∞–Ω–∏–µ Task, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ä–µ–±—ë–Ω–∫–∞
```

## üîó MiniApp –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

Bot —Å–æ–∑–¥–∞—ë—Ç –∫–Ω–æ–ø–∫–∏ WebApp:

- **–†–æ–¥–∏—Ç–µ–ª–∏**: `{WEBAPP_URL}/parent` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏, —Å–µ–º—å—è
- **–î–µ—Ç–∏**: `{WEBAPP_URL}/child` - –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–¥–∞–Ω–∏–π, –º–∞–≥–∞–∑–∏–Ω

MiniApp –¥–æ–ª–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π REST API (M1) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏.

## üìà –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (M3)

1. **üåê MiniApp Frontend**
   - React/Vue/Vanilla JS –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - Telegram WebApp SDK
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ REST API

2. **üõí –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞–≥–∞–∑–∏–Ω–∞**
   - –ö–æ—Ä–∑–∏–Ω–∞, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–æ–∫
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π –æ –ø–æ–∫—É–ø–∫–∞—Ö
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏

3. **üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**
   - –ì—Ä–∞—Ñ–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π
   - –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–µ—Ç–µ–π
   - –°–µ–º–µ–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

4. **üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
   - –ù–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –¥–µ—Ç–µ–π
   - –°–¥–∞—á–∞ –∑–∞–¥–∞–Ω–∏–π –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π
   - –ü–æ–∫—É–ø–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ

5. **üéØ –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è**
   - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –±–µ–π–¥–∂–∏
   - –†–µ–π—Ç–∏–Ω–≥–∏ –¥–µ—Ç–µ–π
   - –ö–≤–µ—Å—Ç—ã –∏ —á–µ–ª–ª–µ–Ω–¥–∂–∏

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

- **M0**: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –º–æ–¥–µ–ª–∏, —Å–µ—Ä–≤–∏—Å—ã
- **M1**: REST API FastAPI ‚úÖ (7/7 E2E —Ç–µ—Å—Ç–æ–≤)
- **M2**: Telegram Bot + MiniApp –∫–Ω–æ–ø–∫–∏ ‚úÖ
- **M3**: MiniApp Frontend (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:

- **Backend**: FastAPI, SQLAlchemy, Alembic
- **Bot**: aiogram 3.x, FSM
- **Database**: SQLite (dev), PostgreSQL (prod)
- **Frontend**: React/Vue + Telegram WebApp SDK

---

**Status**: ‚úÖ M2 Complete - Bot infrastructure ready for MiniApp integration